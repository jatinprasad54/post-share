{"ast":null,"code":"import _slicedToArray from\"D:/REACT/7.Instagram/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button}from'@material-ui/core';import React,{useState}from'react';import{storage,db}from'./Firebase';import firebase from'firebase';import'./ImageUpload.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ImageUpload(_ref){var username=_ref.username;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),caption=_useState2[0],setCaption=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var handleChange=function handleChange(e){if(e.target.files[0]){setImage(e.target.files[0]);}};var handleUpload=function handleUpload(){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);//this upload the image on firebase db\nuploadTask.on(\"state-changed\",function(snapshot){//progress function ...\n//belowed line is just copied\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){//Error function...\nconsole.log(error);alert(error.message);},function(){storage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){//this gets the link of image uploaded on firebase \ndb.collection(\"posts\").add({//adding the image on firebase DB\ntimestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageURL:url,username:username});setProgress(0);setCaption(\"\");setImage(null);});//above code gets the link of image uploaded on firebase\n});};return/*#__PURE__*/_jsxs(\"div\",{className:\"imageupload\",children:[/*#__PURE__*/_jsx(\"progress\",{className:\"imageupload__progress\",value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter a Caption...\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(Button,{onClick:handleUpload,children:\"Upload\"})]});}export default ImageUpload;","map":{"version":3,"sources":["D:/REACT/7.Instagram/instagram-clone/src/ImageUpload.js"],"names":["Button","React","useState","storage","db","firebase","ImageUpload","username","caption","setCaption","image","setImage","progress","setProgress","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageURL","event","value"],"mappings":"2JAAA,OAASA,MAAT,KAAuB,mBAAvB,CACA,MAAOC,CAAAA,KAAP,EAAcC,QAAd,KAA6B,OAA7B,CACA,OAAQC,OAAR,CAAiBC,EAAjB,KAA2B,YAA3B,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,MAAO,mBAAP,C,wFAEA,QAASC,CAAAA,WAAT,MAAiC,IAAXC,CAAAA,QAAW,MAAXA,QAAW,CAC7B,cAA6BL,QAAQ,CAAC,EAAD,CAArC,wCAAOM,OAAP,eAAeC,UAAf,eACA,eAAyBP,QAAQ,CAAC,IAAD,CAAjC,yCAAOQ,KAAP,eAAaC,QAAb,eACA,eAA+BT,QAAQ,CAAC,CAAD,CAAvC,yCAAOU,QAAP,eAAgBC,WAAhB,eAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CACxB,GAAGA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAH,CAAqB,CACjBN,QAAQ,CAACI,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACH,CACJ,CAJD,CAMA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CAC3B,GAAMC,CAAAA,UAAU,CAAGhB,OAAO,CAACiB,GAAR,kBAAsBV,KAAK,CAACW,IAA5B,GAAoCC,GAApC,CAAwCZ,KAAxC,CAAnB,CAAqE;AAErES,UAAU,CAACI,EAAX,CACI,eADJ,CAEI,SAACC,QAAD,CAAc,CACV;AACA;AACA,GAAMZ,CAAAA,QAAQ,CAAGa,IAAI,CAACC,KAAL,CACZF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAkD,GADrC,CAAjB,CAGAf,WAAW,CAACD,QAAD,CAAX,CACH,CATL,CAUI,SAACiB,KAAD,CAAW,CACP;AACAC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACAG,KAAK,CAACH,KAAK,CAACI,OAAP,CAAL,CACH,CAdL,CAeI,UAAM,CACF9B,OAAO,CACLiB,GADF,CACM,QADN,EAEEc,KAFF,CAEQxB,KAAK,CAACW,IAFd,EAGEc,cAHF,GAIEC,IAJF,CAIO,SAACC,GAAD,CAAS,CACX;AACAjC,EAAE,CAACkC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CAAwB;AAC/CC,SAAS,CAACnC,QAAQ,CAACoC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADa,CAEvBnC,OAAO,CAAEA,OAFc,CAGvBoC,QAAQ,CAAEP,GAHa,CAIvB9B,QAAQ,CAAEA,QAJa,CAA3B,EAMAM,WAAW,CAAC,CAAD,CAAX,CACAJ,UAAU,CAAC,EAAD,CAAV,CACAE,QAAQ,CAAC,IAAD,CAAR,CACH,CAfF,EAgBC;AAGJ,CAnCL,EAqCC,CAxCD,CA0CA,mBACI,aAAK,SAAS,CAAC,aAAf,wBACI,iBAAU,SAAS,CAAC,uBAApB,CAA2C,KAAK,CAAEC,QAAlD,CAA4D,GAAG,CAAC,KAAhE,EADJ,cAEI,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,oBAA/B,CAAoD,QAAQ,CAAE,kBAAAiC,KAAK,QAAIpC,CAAAA,UAAU,CAACoC,KAAK,CAAC7B,MAAN,CAAa8B,KAAd,CAAd,EAAnE,CAAuG,KAAK,CAAEtC,OAA9G,EAFJ,cAGI,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEM,YAA7B,EAHJ,cAII,KAAC,MAAD,EAAQ,OAAO,CAAEI,YAAjB,oBAJJ,GADJ,CAUH,CAED,cAAeZ,CAAAA,WAAf","sourcesContent":["import { Button } from '@material-ui/core';\r\nimport React,{useState} from 'react';\r\nimport {storage, db } from './Firebase';\r\nimport firebase from 'firebase';\r\nimport './ImageUpload.css';\r\n\r\nfunction ImageUpload({username}) {\r\n    const [caption,setCaption] = useState('');\r\n    const [image,setImage] = useState(null);\r\n    const [progress,setProgress] = useState(0);\r\n    \r\n    const handleChange = (e) => {\r\n        if(e.target.files[0]){\r\n            setImage(e.target.files[0]);\r\n        }\r\n    }\r\n\r\n    const handleUpload = () => {\r\n    const uploadTask = storage.ref(`images/${image.name}`).put(image);   //this upload the image on firebase db\r\n\r\n    uploadTask.on(\r\n        \"state-changed\",\r\n        (snapshot) => {\r\n            //progress function ...\r\n            //belowed line is just copied\r\n            const progress = Math.round(\r\n                (snapshot.bytesTransferred / snapshot.totalBytes)*100\r\n            );\r\n            setProgress(progress);\r\n        },\r\n        (error) => {\r\n            //Error function...\r\n            console.log(error);\r\n            alert(error.message);\r\n        },\r\n        () => {\r\n            storage\r\n             .ref(\"images\")\r\n             .child(image.name)\r\n             .getDownloadURL()\r\n             .then((url) => {\r\n                 //this gets the link of image uploaded on firebase \r\n                 db.collection(\"posts\").add({                       //adding the image on firebase DB\r\n                     timestamp:firebase.firestore.FieldValue.serverTimestamp(),\r\n                     caption: caption,\r\n                     imageURL: url,\r\n                     username: username\r\n                 })\r\n                 setProgress(0);\r\n                 setCaption(\"\");\r\n                 setImage(null);\r\n             });\r\n             //above code gets the link of image uploaded on firebase\r\n\r\n            \r\n        }\r\n    )\r\n    }\r\n\r\n    return (\r\n        <div className=\"imageupload\">\r\n            <progress className=\"imageupload__progress\"value={progress} max=\"100\" />\r\n            <input type=\"text\" placeholder=\"Enter a Caption...\" onChange={event => setCaption(event.target.value)} value={caption}/>\r\n            <input type=\"file\" onChange={handleChange}/>\r\n            <Button onClick={handleUpload}>\r\n                Upload\r\n            </Button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ImageUpload\r\n"]},"metadata":{},"sourceType":"module"}