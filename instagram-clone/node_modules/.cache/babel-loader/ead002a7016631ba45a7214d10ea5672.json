{"ast":null,"code":"import _regeneratorRuntime from\"D:/REACT/7.Instagram/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/REACT/7.Instagram/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/REACT/7.Instagram/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./App.css';import Post from'./Post';import{auth,db}from'./Firebase';import{makeStyles}from'@material-ui/core/styles';import Modal from'@material-ui/core/Modal';import{Button,Input,Avatar}from'@material-ui/core';import ImageUpload from'./ImageUpload';import InstagramEmbed from'react-instagram-embed';import axios from'./axios';import Pusher from'pusher-js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function getModalStyle(){var top=50;var left=50;return{top:\"\".concat(top,\"%\"),left:\"\".concat(left,\"%\"),transform:\"translate(-\".concat(top,\"%, -\").concat(left,\"%)\")};}var useStyles=makeStyles(function(theme){return{paper:{position:'absolute',width:400,backgroundColor:theme.palette.background.paper,border:'2px solid #000',boxShadow:theme.shadows[5],padding:theme.spacing(2,4,3)}};});function App(){var classes=useStyles();var _React$useState=React.useState(getModalStyle),_React$useState2=_slicedToArray(_React$useState,1),modalStyle=_React$useState2[0];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),username=_useState6[0],setUsername=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),email=_useState10[0],setEmail=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),user=_useState12[0],setUser=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),openSignIn=_useState14[0],setOpenSignIn=_useState14[1];// const [registerOpen, setRegisterOpen] = useState(false);\nuseEffect(function(){var unsubscribe=auth.onAuthStateChanged(function(authUser){if(authUser){// user is logged in...\nconsole.log(authUser);setUser(authUser);if(authUser.displayName){// dont update username\n}else{return authUser.updateProfile({displayName:username});}}else{setUser(null);}});return function(){unsubscribe();};},[user,username]);var fetchPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/sync\").then(function(response){console.log(response);setPosts(response.data);});case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);}));return function fetchPosts(){return _ref.apply(this,arguments);};}();useEffect(function(){var pusher=new Pusher('69305f7a54611f242df4',{cluster:'mt1'});var channel=pusher.subscribe('posts');channel.bind('inserted',function(data){console.log(\"data recieved\",data);fetchPosts();});},[]);useEffect(function(){fetchPosts();},[]);console.log(\"posts are >>>\",posts);var signUp=function signUp(event){event.preventDefault();auth.createUserWithEmailAndPassword(email,password).then(function(authUser){return authUser.user.updateProfile({displayName:username});}).catch(function(error){return alert(error.message);});};var signIn=function signIn(event){event.preventDefault();auth.signInWithEmailAndPassword(email,password).catch(function(error){return alert(error.message);});setOpenSignIn(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(Modal,{open:open,onClose:function onClose(){return setOpen(false);},children:/*#__PURE__*/_jsx(\"div\",{style:modalStyle,className:classes.paper,children:/*#__PURE__*/_jsxs(\"form\",{className:\"app__signup\",children:[/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsx(\"img\",{className:\"app__headerImage\",src:\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\",alt:\"\"})}),/*#__PURE__*/_jsx(Input,{type:\"text\",placeholder:\"username\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(Input,{placeholder:\"email\",type:\"text\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(Input,{placeholder:\"password\",type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",onClick:signUp,children:\"Sign Up\"})]})})}),/*#__PURE__*/_jsx(Modal,{open:openSignIn,onClose:function onClose(){return setOpenSignIn(false);},children:/*#__PURE__*/_jsx(\"div\",{style:modalStyle,className:classes.paper,children:/*#__PURE__*/_jsxs(\"form\",{className:\"app__login\",children:[/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsx(\"img\",{className:\"app__headerImage\",src:\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\",alt:\"\"})}),/*#__PURE__*/_jsx(Input,{placeholder:\"email\",type:\"text\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(Input,{placeholder:\"password\",type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",onClick:signIn,children:\"Login\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"app__header\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"app__headerImage\",src:\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\",alt:\"\"}),(user===null||user===void 0?void 0:user.displayName)?/*#__PURE__*/_jsxs(\"div\",{className:\"app__headerRight\",children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return auth.signOut();},children:\"Logout\"}),/*#__PURE__*/_jsx(Avatar,{className:\"app__headerAvatar\",alt:user.displayName,src:\"/static/images/avatar/1.jpg\"})]}):/*#__PURE__*/_jsxs(\"form\",{className:\"app__loginHome\",children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setOpenSignIn(true);},children:\"Login\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setOpen(true);},children:\"Sign Up\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"app__posts\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"app__postsLeft\",children:posts.map(function(post){return/*#__PURE__*/_jsx(Post,{postId:post._id,user:user,username:post.user,caption:post.caption,imageURL:post.image},post._id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"app__postsRight\",children:/*#__PURE__*/_jsx(InstagramEmbed,{url:\"https://www.instagram.com/p/CLPQDA2hECf/\",clientAccessToken:\"IGQVJYYWlwWDkzVWRPZA2p5cWFUclMxaXZABTFdsNWpBT2Q0YmVPUmFONkE5b3FEdktGTnNJMUoyZADdLVGxQcjRjU05RUjdQYUtDQktJN2xLT3E2TEVtTkNGZAWRTTTJ0aGY2RlE5ckJfWFBHQjdfb1VFUwZDZD\",maxWidth:320,hideCaption:false,containerTagName:\"div\",protocol:\"\",injectScript:true,onLoading:function onLoading(){},onSuccess:function onSuccess(){},onAfterRender:function onAfterRender(){},onFailure:function onFailure(){}})})]}),(user===null||user===void 0?void 0:user.displayName)?/*#__PURE__*/_jsx(\"div\",{className:\"app__upload\",children:/*#__PURE__*/_jsx(ImageUpload,{username:user.displayName})}):/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sorry you need to login to upload\"}),\"  \"]})]});}export default App;","map":{"version":3,"sources":["D:/REACT/7.Instagram/instagram-clone/src/App.js"],"names":["React","useState","useEffect","Post","auth","db","makeStyles","Modal","Button","Input","Avatar","ImageUpload","InstagramEmbed","axios","Pusher","getModalStyle","top","left","transform","useStyles","theme","paper","position","width","backgroundColor","palette","background","border","boxShadow","shadows","padding","spacing","App","classes","modalStyle","posts","setPosts","open","setOpen","username","setUsername","password","setPassword","email","setEmail","user","setUser","openSignIn","setOpenSignIn","unsubscribe","onAuthStateChanged","authUser","console","log","displayName","updateProfile","fetchPosts","get","then","response","data","pusher","cluster","channel","subscribe","bind","signUp","event","preventDefault","createUserWithEmailAndPassword","catch","error","alert","message","signIn","signInWithEmailAndPassword","e","target","value","signOut","map","post","_id","caption","image"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport Post from './Post';\nimport { auth, db } from './Firebase';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\nimport { Button, Input, Avatar } from '@material-ui/core';\nimport ImageUpload from './ImageUpload';\nimport InstagramEmbed from 'react-instagram-embed';\nimport axios from './axios';\nimport Pusher from 'pusher-js';\n\nfunction getModalStyle() {\n  const top = 50;\n  const left = 50;\n\n  return {\n    top: `${top}%`,\n    left: `${left}%`,\n    transform: `translate(-${top}%, -${left}%)`,\n  };\n}\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    position: 'absolute',\n    width: 400,\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3),\n  },\n}));\n\nfunction App() {\n  const classes = useStyles();\n  const [modalStyle] = React.useState(getModalStyle);\n  const [posts, setPosts] = useState([]);\n  const [open, setOpen] = useState(false);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [email, setEmail] = useState('');\n  const [user, setUser] = useState(null);\n  const [openSignIn, setOpenSignIn] = useState(false);\n  // const [registerOpen, setRegisterOpen] = useState(false);\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((authUser) => {\n      if (authUser) {\n        // user is logged in...\n        console.log(authUser);\n        setUser(authUser);\n\n        if (authUser.displayName) {\n          // dont update username\n        } else {\n          return authUser.updateProfile({\n            displayName: username,\n          });\n        }\n      } else {\n        setUser(null);\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [user, username]);\n  \n  const fetchPosts = async () =>\n  await axios.get(\"/sync\").then((response) => { \n    console.log(response);\n    setPosts(response.data);\n  });\n\n  useEffect(() => {\n    const pusher = new Pusher('69305f7a54611f242df4', {\n      cluster: 'mt1'\n    });\n\n    const channel= pusher.subscribe('posts');\n    channel.bind('inserted', (data) => {\n     console.log(\"data recieved\",data);\n     fetchPosts();\n    });\n  },[]);\n  \n  useEffect(() => {\n    fetchPosts();\n  }, []);\n  \n   console.log(\"posts are >>>\",posts); \n\n  const signUp = (event) => {\n    event.preventDefault();\n\n    auth.createUserWithEmailAndPassword(email, password)\n      .then((authUser) => {\n        return authUser.user.updateProfile({\n          displayName: username\n        })\n      })\n      .catch((error) => alert(error.message))\n  }\n\n  const signIn = (event) => {\n    event.preventDefault();\n\n    auth\n      .signInWithEmailAndPassword(email, password)\n      .catch((error) => alert(error.message))\n\n    setOpenSignIn(false);\n  }\n  return (\n    <div className=\"app\">\n\n\n\n      <Modal\n        open={open}\n        onClose={() => setOpen(false)}\n      >\n        <div style={modalStyle} className={classes.paper}>\n          <form className=\"app__signup\">\n            <center>\n              <img\n                className=\"app__headerImage\"\n                src=\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\"\n                alt=\"\"\n              />\n            </center>\n            <Input\n              type=\"text\"\n              placeholder=\"username\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n            />\n            <Input\n              placeholder=\"email\"\n              type=\"text\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n            />\n            <Input\n              placeholder=\"password\"\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n            />\n            <Button type=\"submit\" onClick={signUp}>Sign Up</Button>\n          </form>\n\n\n        </div>\n      </Modal>\n\n      <Modal\n        open={openSignIn}\n        onClose={() => setOpenSignIn(false)}\n      >\n        <div style={modalStyle} className={classes.paper}>\n          <form className=\"app__login\">\n            <center>\n              <img\n                className=\"app__headerImage\"\n                src=\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\"\n                alt=\"\"\n              />\n            </center>\n\n            <Input\n              placeholder=\"email\"\n              type=\"text\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n            />\n            <Input\n              placeholder=\"password\"\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n            />\n            <Button type=\"submit\" onClick={signIn}>Login</Button>\n          </form>\n\n\n        </div>\n      </Modal>\n      <div className=\"app__header\">\n        <img className=\"app__headerImage\"\n          src=\"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png\"\n          alt=\"\"\n        />\n     {user?.displayName ? (\n          <div className=\"app__headerRight\">\n            <Button onClick={() => auth.signOut()}>Logout</Button>\n            <Avatar\n              className=\"app__headerAvatar\"\n              alt={user.displayName}\n              src=\"/static/images/avatar/1.jpg\"\n            />\n          </div>\n        ) : (\n          <form className=\"app__loginHome\">\n            <Button onClick={() => setOpenSignIn(true)}>Login</Button>\n            <Button onClick={() => setOpen(true)}>Sign Up</Button>\n          </form>\n        )}\n      </div>\n\n\n      <div className=\"app__posts\">\n        <div className=\"app__postsLeft\">\n          {posts.map((post) => (\n            <Post key={post._id} postId={post._id}  user={user} username={post.user} caption={post.caption} imageURL={post.image} />\n          ))}\n        </div>\n        <div className=\"app__postsRight\">\n          {/* <h1> Embed</h1> */}\n          <InstagramEmbed\n            url='https://www.instagram.com/p/CLPQDA2hECf/'\n            clientAccessToken='IGQVJYYWlwWDkzVWRPZA2p5cWFUclMxaXZABTFdsNWpBT2Q0YmVPUmFONkE5b3FEdktGTnNJMUoyZADdLVGxQcjRjU05RUjdQYUtDQktJN2xLT3E2TEVtTkNGZAWRTTTJ0aGY2RlE5ckJfWFBHQjdfb1VFUwZDZD'\n            maxWidth={320}\n            hideCaption={false}\n            containerTagName='div'\n            protocol=''\n            injectScript\n            onLoading={() => { }}\n            onSuccess={() => { }}\n            onAfterRender={() => { }}\n            onFailure={() => { }}\n          />\n        </div>\n\n      </div>\n\n\n      {user?.displayName ? (\n        <div className=\"app__upload\">\n        <ImageUpload username={user.displayName} />\n        </div>\n      ) : (\n        <center><h3>Sorry you need to login to upload</h3>  </center>\n        \n      )}\n\n\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}