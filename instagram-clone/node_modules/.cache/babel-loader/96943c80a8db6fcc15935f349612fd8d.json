{"ast":null,"code":"import _slicedToArray from\"D:/REACT/7.Instagram/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button}from'@material-ui/core';import React,{useState}from'react';import{storage,db}from'./Firebase';import firebase from'firebase';import'./ImageUpload.css';import axios from'./axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ImageUpload(_ref){var username=_ref.username;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),caption=_useState2[0],setCaption=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),url=_useState8[0],setUrl=_useState8[1];var handleChange=function handleChange(e){//this select the file to be uploaded and stored in image\nif(e.target.files[0]){setImage(e.target.files[0]);}};//this upload the image on firebase databse\nvar handleUpload=function handleUpload(){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);//here we get into storage and ref and then uploading the image on firebase DB\nuploadTask.on(\"state_changed\",function(snapshot){//progress function ...\n//belowed line is just copied\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){//Error function...\nconsole.log(error);alert(error.message);},function(){storage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){//Getting the link of image uploaded on firebase DB\nsetUrl(url);axios.post('/upload',{caption:caption,user:username,image:url});//this gets the link of image uploaded on firebase \ndb.collection(\"posts\").add({//adding the image with caption on firebase Collections DB\ntimestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageURL:url,username:username});setProgress(0);setCaption(\"\");setImage(null);});//above code gets the link of image uploaded on firebase\n});};return/*#__PURE__*/_jsxs(\"div\",{className:\"imageupload\",children:[/*#__PURE__*/_jsx(\"progress\",{className:\"imageupload__progress\",value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter a Caption...\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(Button,{className:\"imageUpload__button\",onClick:handleUpload,children:\"Upload\"})]})]});}export default ImageUpload;","map":{"version":3,"sources":["D:/REACT/7.Instagram/instagram-clone/src/ImageUpload.js"],"names":["Button","React","useState","storage","db","firebase","axios","ImageUpload","username","caption","setCaption","image","setImage","progress","setProgress","url","setUrl","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","post","user","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageURL","event","value"],"mappings":"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","sourcesContent":["import { Button } from '@material-ui/core';\r\nimport React,{useState} from 'react';\r\nimport {storage, db } from './Firebase';\r\nimport firebase from 'firebase';\r\nimport './ImageUpload.css';\r\nimport axios from './axios';\r\n\r\nfunction ImageUpload({username}) {\r\n    const [caption,setCaption] = useState('');\r\n    const [image,setImage] = useState(null);\r\n    const [progress,setProgress] = useState(0);\r\n    const [url,setUrl] = useState(\"\");\r\n    \r\n    const handleChange = (e) => {       //this select the file to be uploaded and stored in image\r\n        if(e.target.files[0]){\r\n            setImage(e.target.files[0]);\r\n        }\r\n    }\r\n    \r\n    //this upload the image on firebase databse\r\n    const handleUpload = () => {\r\n    const uploadTask = storage.ref(`images/${image.name}`).put(image);    //here we get into storage and ref and then uploading the image on firebase DB\r\n\r\n    uploadTask.on(\r\n        \"state_changed\",\r\n        (snapshot) => {\r\n            //progress function ...\r\n            //belowed line is just copied\r\n            const progress = Math.round(\r\n                (snapshot.bytesTransferred / snapshot.totalBytes)*100\r\n            );\r\n            setProgress(progress);\r\n        },\r\n        (error) => {\r\n            //Error function...\r\n            console.log(error);\r\n            alert(error.message);\r\n        },\r\n        () => {\r\n            storage\r\n             .ref(\"images\")\r\n             .child(image.name)\r\n             .getDownloadURL()\r\n             .then((url) => {      //Getting the link of image uploaded on firebase DB\r\n\r\n                setUrl(url);\r\n\r\n                axios.post('/upload',{         \r\n                  caption: caption,\r\n                  user: username,\r\n                  image: url\r\n                });\r\n                 //this gets the link of image uploaded on firebase \r\n                 db.collection(\"posts\").add({                       //adding the image with caption on firebase Collections DB\r\n                     timestamp:firebase.firestore.FieldValue.serverTimestamp(),\r\n                     caption: caption,\r\n                     imageURL: url,\r\n                     username: username,\r\n                 })\r\n                 setProgress(0);\r\n                 setCaption(\"\");\r\n                 setImage(null);\r\n             });\r\n             //above code gets the link of image uploaded on firebase\r\n\r\n            \r\n        }\r\n    );\r\n    };\r\n\r\n    return (\r\n        <div className=\"imageupload\">\r\n            <progress className=\"imageupload__progress\" value={progress} max=\"100\" />\r\n            <input type=\"text\" placeholder=\"Enter a Caption...\" onChange={event => setCaption(event.target.value)} value={caption}/>\r\n            <div>   \r\n            <input type=\"file\" onChange={handleChange}/>\r\n            <Button className=\"imageUpload__button\" onClick={handleUpload}>\r\n                Upload\r\n            </Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ImageUpload\r\n"]},"metadata":{},"sourceType":"module"}